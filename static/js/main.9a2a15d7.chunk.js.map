{"version":3,"sources":["App.js","index.js"],"names":["App","props","makeResponse","groupName","a","offset","field","bridge","send","state","version","access_token","data","response","console","log","getGroupId","group","membersPrepare","ban","ownMembers","Set","membersList","otherName","otherGroupName","ownName","ownGroupName","groupId","otherCount","ownCount","forEach","item","i","add","has","banMembers","toBanList","size","user_id","sendPromise","then","catch","error","url","appId","window","open","homeurl","onChange","bind","e","currentTarget","name","value","this","setState","activePanel","id","type","top","onClick","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9a2a15d7.chunk.js","sourcesContent":["import React from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport { View, Panel, PanelHeader, Button, FormLayout, Input } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      ownGroupName: 'noryon',\n\t\t\tgroupId: 0,\n      otherGroupName: 'physmach',\n\t\t\tappId: '7375559',\n\t\t\tversion: '5.103',\n\t\t\taccess_token: '945b434ecae06d43b09613546f59a553909ae4ebbacf9bfbc9584f0ca02f7faf8a09afbfb8d2c093f3906',\n\t\t\thomeurl: 'https://egorovm.github.io/vk-app/'\n    }\n\n    this.onChange = this.onChange.bind(this);\n  }\n\n  onChange(e) {\n    const { name, value } = e.currentTarget;\n    this.setState({ [name]: value });\n  }\n\n\tmakeResponse = async(groupName, offset=0, field) => {\n\t\ttry {\n\t\t\tconst data = await bridge.send(\n\t\t\t\t'VKWebAppCallAPIMethod',\n\t\t\t\t{\n\t\t\t\t\t\"method\": \"groups.getMembers\",\n\t\t\t \t\t\"params\": {\"group_id\": groupName, \"offset\": offset, \"v\": this.state.version, \"access_token\": this.state.access_token}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn data.response[field];\n\n\t\t} catch (error) {\n\t\t\tconsole.log('groups.getMembers', error);\n\t\t  return error;\n\t\t}\n\t}\n\n\tgetGroupId = async(groupName) => {\n\t\ttry{\n\t\t\tconst group = await bridge.send(\n\t\t\t\t'VKWebAppCallAPIMethod',\n\t\t\t\t{\n\t\t\t\t\t\"method\": \"groups.getById\",\n\t\t\t\t\t\"params\": {\"group_id\": groupName, \"v\": this.state.version, \"access_token\": this.state.access_token}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn group.response[0]['id'];\n\t\t}catch(error){\n\t\t\tconsole.log('groups.getByID', error);\n\t\t\treturn error;\n\t\t}\n\n\t}\n\n\tmembersPrepare = async (ban=true) => {\n\t\tvar ownMembers = new Set();\n\t\tvar membersList = new Set();\n\n\t\tconst otherName = this.state.otherGroupName;\n\t\tconst ownName = this.state.ownGroupName;\n\n\t\tconst groupId = await this.getGroupId(ownName);\n\n\t\tconst otherCount = await this.makeResponse(otherName, 0, 'count');\n\t\tconst ownCount = await this.makeResponse(ownName, 0, 'count');\n\n\t\tfor(var offset = 0; offset < ownCount; offset += 1000){\n\t\t\t\tvar members = await this.makeResponse(ownName, offset, 'items');\n\n\t\t\t\tmembers.forEach((item, i) => {\n\t\t\t\t\townMembers.add(item);\n\t\t\t\t});\n\t\t}\n\n\t\tfor(var offset = 0; offset < otherCount; offset += 1000){\n\t\t\t\tvar members = await this.makeResponse(otherName, offset, 'items');\n\n\t\t\t\tmembers.forEach((item, i) => {\n\t\t\t\t\tif(ownMembers.has(item)) membersList.add(item);\n\t\t\t\t});\n\t\t}\n\n\t\tthis.banMembers(groupId, membersList, ban);\n\t}\n\n\tbanMembers = async (groupId, toBanList, ban) => {\n\t\tconsole.log(toBanList.size)\n\t\ttoBanList.forEach((user_id) => {\n\t\t\tconsole.log('send', user_id);\n\t\t\tconsole.log('send', ban ? \"groups.ban\" : \"groups.unban\")\n\n\t\t\tbridge.sendPromise(\n\t\t\t\t\"VKWebAppCallAPIMethod\",\n\t\t\t\t{\"method\" : ban ? \"groups.ban\" : \"groups.unban\",\n\t\t\t\t\"params\" : {\"group_id\": groupId, \"owner_id\": user_id, \"v\": this.state.version, \"access_token\": this.state.access_token}}\n\t\t\t).then(data => {console.log('success', data)})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(error);\n\t\t\t\tvar url = `https://oauth.vk.com/authorize?client_id=${this.state.appId}&display=page&redirect_uri=https://localhost:10888&scope=groups&response_type=token&v=${this.state.version}&revoke=1`\n\t\t\t\tconsole.log(url);\n\t\t\t\twindow.open(url);\n\t\t\t\treturn;\n\t\t\t});\n\t\t});\n\n\t\tconsole.log('успешно');\n\t}\n\n  render() {\n    return (\n      <View activePanel=\"new-user\">\n        <Panel id=\"new-user\">\n          <PanelHeader>Vk-App</PanelHeader>\n          <FormLayout>\n\n\t\t\t\t\t\t<Input onChange={this.onChange} value={this.state.ownGroupName} name=\"ownGroupName\" type=\"text\" top=\"Название вашей группы\"/>\n            <Input onChange={this.onChange} value={this.state.otherGroupName} name=\"otherGroupName\" type=\"text\" top=\"Название рассматриваемой группы\"/>\n\n\t\t\t\t\t\t<Button onClick={this.membersPrepare} type=\"submit\" size=\"xl\">Забанить пересечение</Button>\n\t\t\t\t\t\t<Button onClick={this.membersPrepare} type=\"submit\" size=\"xl\">Разбанить пересечение</Button>\n\n          </FormLayout>\n        </Panel>\n      </View>\n    );\n  }\n}\n\nexport default App;\n","import \"core-js/features/map\";\nimport \"core-js/features/set\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(eruda => {}); //runtime download\n}\n"],"sourceRoot":""}